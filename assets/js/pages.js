var pages,trivia,bgImage,folder,LEDname,page=0,pageinput=document.getElementById("page"),b_next=document.getElementById("b_next"),b_prev=document.getElementById("b_prev"),b_jumpto=document.getElementById("b_jumpto"),textdiv=document.getElementById("episode"),triviadiv=document.getElementById("trivia"),screendiv=document.getElementById("screen"),basediv=document.getElementById("basegeneric"),LEDdiv=document.getElementById("indicator"),glowdiv=document.getElementById("glow"),epheaddiv=document.getElementById("ephead"),epcontroldiv=document.getElementById("epcontrol"),nojscontentdiv=document.getElementById("nojscontent"),footer=document.querySelector("footer"),epcontent=textdiv.innerHTML,scriptmode=!1;window.matchMedia("(max-width: 700px)").matches&&(b_next.href="#screen",b_prev.href="#screen"),document.getElementById("b_js").onclick=function(){(scriptmode=!scriptmode)?(epheaddiv.classList.add("nojs"),epcontroldiv.classList.add("nojs"),episode.classList.add("nojs"),nojscontent.classList.add("nojs"),footer.classList.add("nojs")):(epheaddiv.classList.remove("nojs"),epcontroldiv.classList.remove("nojs"),episode.classList.remove("nojs"),nojscontent.classList.remove("nojs"),footer.classList.remove("nojs"))};var epcontentsize=(epcontent=epcontent.split("<p>///</p>")).length;if(epcontent[0].includes("SCREEN")){var screencontent=epcontent[0];basediv.innerHTML=screencontent,1==epcontentsize?epcontent[0]=epcontent[1]:epcontent=epcontent.slice(1,epcontentsize)}else textdiv.innerHTML=epcontent[0];function nextPage(){page<pages-1&&updatePage(++page)}function prevPage(){page>0&&updatePage(--page)}function detectswipe(e){if(!scriptmode){swipe_det=new Object,swipe_det.sX=0,swipe_det.sY=0,swipe_det.eX=0,swipe_det.eY=0;var t="";ele=document.body,ele.addEventListener("touchstart",function(e){var t=e.touches[0];swipe_det.sX=t.screenX,swipe_det.sY=t.screenY},!1),ele.addEventListener("touchmove",function(e){e.preventDefault();var t=e.touches[0];swipe_det.eX=t.screenX,swipe_det.eY=t.screenY},!1),ele.addEventListener("touchend",function(n){(swipe_det.eX-80>swipe_det.sX||swipe_det.eX+80<swipe_det.sX)&&swipe_det.eY<swipe_det.sY+120&&swipe_det.sY>swipe_det.eY-120&&swipe_det.eX>0?t=swipe_det.eX>swipe_det.sX?"r":"l":(swipe_det.eY-50>swipe_det.sY||swipe_det.eY+50<swipe_det.sY)&&swipe_det.eX<swipe_det.sX+30&&swipe_det.sX>swipe_det.eX-30&&swipe_det.eY>0&&(t=swipe_det.eY>swipe_det.sY?"d":"u"),""!=t&&"function"==typeof e&&e(t),t="",swipe_det.sX=0,swipe_det.sY=0,swipe_det.eX=0,swipe_det.eY=0},!1)}}function swipefff(e){"l"==e&&nextPage(),"r"==e&&prevPage()}function checkKey(e){scriptmode||("37"==(e=e||window.event).keyCode?prevPage():"39"==e.keyCode&&nextPage())}function jumpTo(){var e=pageinput.value;updatePage(e?e>=0&&e<pages&&-0!=e?page=e:e>pages-1?page=pages-1:e<=0?page=0:page:page)}function setBGimg(e,t,n){bgImage=e.split("BG=")[1].split("--\x3e")[0],t.style.backgroundImage="url(/wasteware/assets/img/assets/lines.png), url(/wasteware/assets/img/"+n+bgImage+")",t.style.backgroundSize="auto, 100%, 100%"}function updatePage(e){if(epcontent[e].includes("SAME"))for(t=e;t>=0;)epcontent[t].includes("SAME")?t--:(textdiv.innerHTML=epcontent[t],t=-1);else textdiv.innerHTML=epcontent[e],epcontent[e+1]&&(epcontent[e+1].includes("SAME")||textdiv.scrollTo(0,0));var t;if(0==page?b_prev.classList.add("inactive"):b_prev.classList.remove("inactive"),page==pages-1?b_next.classList.add("inactive"):b_next.classList.remove("inactive"),epcontent[e].includes("BG="))setBGimg(epcontent[e],screendiv,folder);else for(t=e;t>=0;)epcontent[t].includes("BG=")?(setBGimg(epcontent[t],screendiv,folder),t=-1):t--;function n(e){"off"!=(LEDname=e.split("LED=")[1].split("--\x3e")[0])?(LEDdiv.style.backgroundColor="var(--LED-"+LEDname+")",glowdiv.style.backgroundColor="var(--LED-"+LEDname+")",LEDdiv.style.boxShadow="none"):(LEDdiv.style.backgroundColor="",glowdiv.style.backgroundColor="",LEDdiv.style.boxShadow="")}if(epcontent[e].includes("LED="))n(epcontent[e]);else for(t=e;t>=0;)epcontent[t].includes("LED=")?(n(epcontent[t]),t=-1):t--;if(epcontent[e+1]&&epcontent[e+1].includes("BG=")&&(bgImage=epcontent[e+1].split("BG=")[1].split("--\x3e")[0],document.getElementById("preload").style.backgroundImage="url(/wasteware/assets/img/"+folder+bgImage+")"),epcontent[e].includes("TRIVIA="))trivia=epcontent[e].split("TRIVIA=")[1].split("--\x3e")[0],triviadiv.innerHTML=trivia;else for(t=e;t>=0;)epcontent[t].includes("TRIVIA=")?(trivia=epcontent[t].split("TRIVIA=")[1].split("--\x3e")[0],triviadiv.innerHTML=trivia,t=-1):t--;pageinput.value=e}pages=epcontent.length,detectswipe(swipefff),document.onkeydown=checkKey,b_next.onclick=function(){nextPage()},b_prev.onclick=function(){prevPage()},pageinput.addEventListener("keyup",function(e){"Enter"===e.key&&jumpTo()}),b_jumpto.onclick=function(){jumpTo()},folder=epcontent[0].includes("EPFOLDER=")?"episodes/"+epcontent[0].match(/EPFOLDER=(\d+\/\d+)/)[1]+"/":"",updatePage(page);
